const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["static/lycropper.Bu0YJLMB.js","static/cropperjs.D2cVOR96.js","static/cropperjs.Bs3gl52x.css","static/index.CmK67jVc.js","static/@vue.CTPu-uAZ.js","static/element-plus.BU70F6Fx.js","static/lodash-es.inYd2OMh.js","static/@vueuse.CxA-JytG.js","static/@element-plus.DmP6zw14.js","static/@popperjs.CT_jBSb5.js","static/@ctrl.D-8vaqgC.js","static/dayjs.Gu-B5VJn.js","static/clipboard.DkQLcScs.js","static/async-validator.j0i5Y79Y.js","static/memoize-one.BAtLgO95.js","static/normalize-wheel-es.BhHBPXsK.js","static/@floating-ui.CzXNizXq.js","static/element-plus.Ba_xEelw.css","static/axios.DpIj8wd6.js","static/crypto-js.CDMBIImi.js","static/js-cookie.Ch5AnFJE.js","static/pinia.zQpyPaWK.js","static/xe-utils.D2X37hqE.js","static/sortablejs.C7MwSjUq.js","static/vue-i18n.Diqqvor5.js","static/@intlify.CzB25nlE.js","static/file-saver.B7Ix4MNR.js","static/pinia-plugin-persistedstate.C_byIVBZ.js","static/destr.WfmzGWA8.js","static/deep-pick-omit.CDZeMyKV.js","static/vue-router.kfYy4LLd.js","static/nprogress.CyzJYN2f.js","static/nprogress.BgDCIyLK.css","static/@tsparticles.Csp0zpCD.js","static/index.WITXI7w2.css","static/lycropper.CQ2AnE5e.css"])))=>i.map(i=>d[i]);
import{_ as e,l as t,A as l,h as a,D as i}from"./index.CmK67jVc.js";import{aB as s,al as r,c as o,o as p,O as c,K as d,a as u,T as n,L as h,E as m,F as f,P as g,R as y,Q as F,G as b}from"./@vue.CTPu-uAZ.js";import{g as v}from"./element-plus.BU70F6Fx.js";const _=s(()=>i(()=>import("./lycropper.Bu0YJLMB.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35]))),w={emits:["onSuccess","update:modelValue"],props:{modelValue:{type:String,default:""},successCode:{type:Number,default:2e3},height:{type:Number,default:148},width:{type:Number,default:148},title:{type:String,default:""},icon:{type:String,default:"plus"},action:{type:String,default:""},apiObj:{type:Function,default:l.apiSysImgUpload},name:{type:String,default:"file"},data:{type:Object,default:()=>{}},accept:{type:String,default:"image/gif, image/jpeg, image/png"},maxSize:{type:Number,default:10},limit:{type:Number,default:1},autoUpload:{type:Boolean,default:!0},showFileList:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},round:{type:Boolean,default:!1},onSuccess:{type:Function,default:()=>!0},cropper:{type:Boolean,default:!1},compress:{type:Number,default:1},aspectRatio:{type:Number,default:NaN}},components:{lyCropper:_,lyDialog:t},data(){return{value:"",file:null,style:{width:this.width+"px",height:this.height+"px"},cropperDialogVisible:!1,cropperFile:null}},watch:{modelValue(e){this.value=e,this.newFile(e)},value(e){this.$emit("update:modelValue",e)}},mounted(){this.value=this.modelValue,this.newFile(this.modelValue)},methods:{newFile(e){this.file=e?{status:"success",url:e}:null},cropperSave(){this.$refs.cropper.getCropFile(e=>{e.uid=this.cropperFile.uid,this.cropperFile.raw=e,this.file=this.cropperFile,this.file.tempFile=URL.createObjectURL(this.file.raw),this.$refs.uploader.submit()},this.cropperFile.name,this.cropperFile.type),this.cropperDialogVisible=!1},cropperClosed(){URL.revokeObjectURL(this.cropperFile.tempCropperFile),delete this.cropperFile.tempCropperFile},handleRemove(){this.clearFiles()},clearFiles(){URL.revokeObjectURL(this.file.tempFile),this.value="",this.file=null,this.$nextTick(()=>{this.$refs.uploader.clearFiles()})},change(e,t){if(t.length>1&&t.splice(0,1),this.cropper&&"ready"==e.status){return["image/gif","image/jpeg","image/png"].includes(e.raw.type)?(this.cropperFile=e,this.cropperFile.tempCropperFile=URL.createObjectURL(e.raw),this.cropperDialogVisible=!0,!1):(this.$notify.warning({title:"\u4e0a\u4f20\u6587\u4ef6\u8b66\u544a",message:"\u9009\u62e9\u7684\u6587\u4ef6\u975e\u56fe\u50cf\u7c7b\u6587\u4ef6"}),!1)}this.file=e,"ready"==e.status&&(e.tempFile=URL.createObjectURL(e.raw))},before(e){if(!this.accept.replace(/\s/g,"").split(",").includes(e.type))return this.$notify.warning({title:"\u4e0a\u4f20\u6587\u4ef6\u8b66\u544a",message:"\u9009\u62e9\u7684\u6587\u4ef6\u975e\u56fe\u50cf\u7c7b\u6587\u4ef6"}),this.clearFiles(),!1;return e.size/1024/1024<this.maxSize?void 0:(this.$message.warning(`\u4e0a\u4f20\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc7 ${this.maxSize}MB!`),this.clearFiles(),!1)},handleExceed(e){const t=e[0];t.uid=v(),this.$refs.uploader.handleStart(t)},success(e,t){if(URL.revokeObjectURL(t.tempFile),delete t.tempFile,e){var l=this.onSuccess(e,t);if(null!=l&&0==l)return!1;let i="";i=e.data.data[0].indexOf("://")>=0?e.data.data[0]:a.API_BASEURL.split("/api")[0]+e.data.data[0],t.url=i,this.value=t.url}this.$emit("onSuccess",this.value)},error(e){this.$nextTick(()=>{this.clearFiles()}),this.$notify.error({title:"\u4e0a\u4f20\u6587\u4ef6\u672a\u6210\u529f",message:e})},async request(e){var t=this.apiObj;let l=await t(e);l.code==this.successCode?e.onSuccess(l):e.onError(l.msg||"\u672a\u77e5\u9519\u8bef")}}},R={key:0,class:"ly-upload__uploading"},S={class:"ly-upload__progress"},V={key:1,class:"ly-upload__img"},L={key:0,class:"ly-upload__img-actions"},U={class:"file-empty"},C={key:0},k={style:{display:"none!important"}};const x=e(w,[["render",function(e,t,l,a,i,s){const v=r("el-progress"),_=r("ly-image"),w=r("Delete"),x=r("el-icon"),j=r("el-upload"),$=r("el-input"),O=r("lyCropper"),D=r("el-button"),N=r("lyDialog");return p(),o("div",{class:b(["ly-upload",{"ly-upload-round":l.round}]),style:f(i.style)},[i.file&&"success"!=i.file.status?(p(),o("div",R,[u("div",S,[n(v,{percentage:i.file.percentage,"text-inside":!0,"stroke-width":16},null,8,["percentage"])]),n(_,{class:"image",src:i.file.tempFile,fit:"cover"},null,8,["src"])])):c("",!0),i.file&&"success"==i.file.status?(p(),o("div",V,[n(_,{class:"image",src:i.file.url,"preview-src-list":[i.file.url],fit:"cover","hide-on-click-modal":"","preview-teleported":""},{placeholder:h(()=>[...t[4]||(t[4]=[u("div",{class:"ly-upload__img-slot"}," Loading... ",-1)])]),_:1},8,["src","preview-src-list"]),l.disabled?c("",!0):(p(),o("div",L,[u("span",{class:"del",onClick:t[0]||(t[0]=e=>s.handleRemove())},[n(x,null,{default:h(()=>[n(w)]),_:1})])]))])):c("",!0),i.file?c("",!0):(p(),d(j,{key:2,class:"uploader",ref:"uploader","auto-upload":!l.cropper&&l.autoUpload,disabled:l.disabled,"show-file-list":l.showFileList,action:l.action,name:l.name,data:l.data,accept:l.accept,limit:1,"http-request":s.request,"on-change":s.change,"before-upload":s.before,"on-success":s.success,"on-error":s.error,"on-exceed":s.handleExceed},{default:h(()=>[m(e.$slots,"default",{},()=>[u("div",{class:"el-upload--picture-card",style:f(i.style)},[u("div",U,[n(x,null,{default:h(()=>[(p(),d(g(l.icon)))]),_:1}),l.title?(p(),o("h4",C,y(l.title),1)):c("",!0)])],4)],!0)]),_:3},8,["auto-upload","disabled","show-file-list","action","name","data","accept","http-request","on-change","before-upload","on-success","on-error","on-exceed"])),u("span",k,[n($,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e)},null,8,["modelValue"])]),n(N,{bodyPadding:0,title:"\u526a\u88c1",draggable:"",modelValue:i.cropperDialogVisible,"onUpdate:modelValue":t[3]||(t[3]=e=>i.cropperDialogVisible=e),width:"780px",onClosed:s.cropperClosed,"destroy-on-close":""},{footer:h(()=>[n(D,{onClick:t[2]||(t[2]=e=>i.cropperDialogVisible=!1)},{default:h(()=>[...t[5]||(t[5]=[F("\u53d6 \u6d88",-1)])]),_:1}),n(D,{type:"primary",onClick:s.cropperSave},{default:h(()=>[...t[6]||(t[6]=[F("\u786e \u5b9a",-1)])]),_:1},8,["onClick"])]),default:h(()=>[n(O,{src:i.cropperFile.tempCropperFile,compress:l.compress,aspectRatio:l.aspectRatio,ref:"cropper"},null,8,["src","compress","aspectRatio"])]),_:1},8,["modelValue","onClosed"])],6)}],["__scopeId","data-v-7d2e35e8"]]);export{x as p};
