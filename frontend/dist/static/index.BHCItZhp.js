import{_ as e,b as a,A as s,s as t,i as l,a as o,u as r,h as i}from"./index.CmK67jVc.js";import{u as n}from"./vue-router.kfYy4LLd.js";import{r as c,b as p,al as m,K as d,o as u,L as g,T as f,O as h,u as v,Q as j,a5 as b,c as y,a as w,R as _}from"./@vue.CTPu-uAZ.js";import{a as k}from"./element-plus.BU70F6Fx.js";import{P as x,B as C}from"./tsParticles.C10nsZtR.js";import"./axios.DpIj8wd6.js";import"./crypto-js.CDMBIImi.js";import"./clipboard.DkQLcScs.js";import"./js-cookie.Ch5AnFJE.js";import"./pinia.zQpyPaWK.js";import"./@element-plus.DmP6zw14.js";import"./xe-utils.D2X37hqE.js";import"./sortablejs.C7MwSjUq.js";import"./vue-i18n.Diqqvor5.js";import"./@intlify.CzB25nlE.js";import"./file-saver.B7Ix4MNR.js";import"./lodash-es.inYd2OMh.js";import"./pinia-plugin-persistedstate.C_byIVBZ.js";import"./destr.WfmzGWA8.js";import"./deep-pick-omit.CDZeMyKV.js";import"./nprogress.CyzJYN2f.js";import"./@tsparticles.Csp0zpCD.js";import"./@vueuse.CxA-JytG.js";import"./@popperjs.CT_jBSb5.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.Gu-B5VJn.js";import"./async-validator.j0i5Y79Y.js";import"./memoize-one.BAtLgO95.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.CzXNizXq.js";const V=e({__name:"modulePasswordForm",setup(e){const r=a(),i=window.location.origin,y=n();let w=c({username:"",password:"",captcha:"",captchaKey:null}),_=c(null),x=[{required:!0,message:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",trigger:"blur"}],C=c({username:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d26\u53f7",trigger:"blur"}],password:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801",trigger:"blur"}]}),V=c(!1);function P(){s.getCaptcha().then(e=>{2e3==e.code?(w.value.captcha=null,w.value.captchaKey=e.data.key,_.value=e.data.image_base):k.error(e.msg)})}let A=c(null);const T=async()=>{if(!V.value)try{V.value=!0,await A.value.validate();const e=await s.getToken(w.value);2e3===e.code?(V.value=!0,t("logintoken",e.data.access),l("refreshtoken",e.data.refresh),await r.getSystemWebRouter(y),function(){let e=o().activeTab;e?y.push(e):window.location.href=i+"/#/"}(),k.success("\u767b\u5f55\u6210\u529f"),V.value=!1):(k.error(e.msg||"\u767b\u5f55\u5931\u8d25"),P())}catch(e){e.fields?k.warning("\u8bf7\u586b\u5199\u6b63\u786e\u7684\u767b\u5f55\u4fe1\u606f"):k.error("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")}finally{V.value=!1}};return p(()=>{P()}),(e,a)=>{const s=m("el-input"),t=m("el-form-item"),l=m("ly-img"),o=m("el-button"),i=m("el-form");return u(),d(i,{ref_key:"loginFormRef",ref:A,model:v(w),rules:v(C),"label-width":"0",size:"large",onKeyup:b(T,["enter"]),disabled:v(V)},{default:g(()=>[f(t,{prop:"username"},{default:g(()=>[f(s,{modelValue:v(w).username,"onUpdate:modelValue":a[0]||(a[0]=e=>v(w).username=e),"prefix-icon":"user",clearable:"",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},null,8,["modelValue"])]),_:1}),f(t,{prop:"password"},{default:g(()=>[f(s,{modelValue:v(w).password,"onUpdate:modelValue":a[1]||(a[1]=e=>v(w).password=e),"prefix-icon":"lock",clearable:"","show-password":"",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"},null,8,["modelValue"])]),_:1}),v(r).sysConfig.loginCaptcha?(u(),d(t,{key:0,prop:"captcha"},{default:g(()=>[f(s,{type:"text","prefix-icon":"circle-check",modelValue:v(w).captcha,"onUpdate:modelValue":a[2]||(a[2]=e=>v(w).captcha=e),modelModifiers:{trim:!0},"auto-complete":"off",placeholder:"\u9a8c\u8bc1\u7801",rules:v(r).sysConfig.loginCaptcha?v(x):[]},{append:g(()=>[f(l,{class:"login-captcha",src:v(_),onClick:P},null,8,["src"])]),_:1},8,["modelValue","rules"])]),_:1})):h("",!0),f(t,null,{default:g(()=>[f(o,{type:"primary",class:"login-btn",style:{width:"100%"},loading:v(V),round:"",onClick:T},{default:g(()=>[...a[3]||(a[3]=[j("\u767b\u5f55",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","disabled"])}}},[["__scopeId","data-v-02b8d917"]]),P={class:"login-container"},A={class:"background-layer"},T={class:"login-card"},q={class:"theme-toggle"},z={class:"login-content"},E={class:"brand-section"},K={class:"logo-wrapper"},R={class:"app-name"},S={class:"form-section"},M={class:"login-footer"},U={class:"copyright"},F={class:"version"},I=e({__name:"index",setup(e){const s=a();n();const t=r();function l(){t.setSiteTheme("light"===t.siteTheme?"dark":"light")}return p(()=>{s.getSystemConfig();const e=document.querySelector("meta[name='viewport']")||document.createElement("meta");e.name="viewport",e.content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no",document.head.appendChild(e)}),(e,a)=>{const o=m("el-button"),r=m("el-tooltip"),n=m("ly-img"),c=m("el-tab-pane"),p=m("el-tabs");return u(),y("div",P,[w("div",A,[f(x),a[0]||(a[0]=w("div",{class:"gradient-overlay"},null,-1))]),w("div",T,[w("div",q,[f(r,{content:"dark"==v(t).siteTheme?"\u5207\u6362\u81f3\u4eae\u8272\u6a21\u5f0f":"\u5207\u6362\u81f3\u6697\u8272\u6a21\u5f0f"},{default:g(()=>[f(o,{icon:"dark"==v(t).siteTheme?"sunny":"moon",circle:"",class:"theme-btn",onClick:l},null,8,["icon"])]),_:1},8,["content"])]),w("div",z,[w("div",E,[w("div",K,[f(n,{alt:v(i).APP_NAME,src:v(s).sysConfig.logo,class:"logo-image"},null,8,["alt","src"])]),w("h1",R,_(v(i).APP_NAME),1),a[1]||(a[1]=w("p",{class:"welcome-text"},"\u6b22\u8fce\u56de\u6765\uff0c\u8bf7\u767b\u5f55\u60a8\u7684\u8d26\u6237",-1))]),w("div",S,[f(p,{class:"auth-tabs"},{default:g(()=>[f(c,{label:"\u8d26\u53f7\u5bc6\u7801\u767b\u5f55",lazy:""},{default:g(()=>[f(V)]),_:1})]),_:1})])]),w("div",M,[w("p",U,[a[2]||(a[2]=j("\xa9 2025 lybbn All rights reserved. ",-1)),w("span",F,"v"+_(v(i).APP_VER),1)])])]),f(C)])}}},[["__scopeId","data-v-b261ff2b"]]);export{I as default};
