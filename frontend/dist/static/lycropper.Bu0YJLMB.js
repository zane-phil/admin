import{C as e}from"./cropperjs.D2cVOR96.js";import{_ as a}from"./index.CmK67jVc.js";import{r as t,j as s,k as l,b as i,Y as o,al as r,c as p,o as n,a as u,T as m,O as v,L as c,S as d,a7 as j,Q as g,R as y}from"./@vue.CTPu-uAZ.js";import"./element-plus.BU70F6Fx.js";import"./lodash-es.inYd2OMh.js";import"./@vueuse.CxA-JytG.js";import"./@element-plus.DmP6zw14.js";import"./@popperjs.CT_jBSb5.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.Gu-B5VJn.js";import"./clipboard.DkQLcScs.js";import"./async-validator.j0i5Y79Y.js";import"./memoize-one.BAtLgO95.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.CzXNizXq.js";import"./axios.DpIj8wd6.js";import"./crypto-js.CDMBIImi.js";import"./js-cookie.Ch5AnFJE.js";import"./pinia.zQpyPaWK.js";import"./xe-utils.D2X37hqE.js";import"./sortablejs.C7MwSjUq.js";import"./vue-i18n.Diqqvor5.js";import"./@intlify.CzB25nlE.js";import"./file-saver.B7Ix4MNR.js";import"./pinia-plugin-persistedstate.C_byIVBZ.js";import"./destr.WfmzGWA8.js";import"./deep-pick-omit.CDZeMyKV.js";import"./vue-router.kfYy4LLd.js";import"./nprogress.CyzJYN2f.js";import"./@tsparticles.Csp0zpCD.js";const b={class:"ly-cropper-container"},h={class:"ly-cropper"},f={class:"ly-cropper__img-container"},_={class:"ly-cropper__controls"},w={class:"ly-cropper__dimensions"},x={class:"dimension-controls"},C={class:"dimension-input"},R={class:"dimension-input"},D={key:0,class:"aspect-ratio-controls"},k={class:"ly-cropper__preview"},z=a({__name:"lycropper",props:{src:{type:String,required:!0,validator:e=>/\.(jpe?g|png|gif|bmp|webp)$/i.test(e)},compress:{type:Number,default:.8,validator:e=>e>0&&e<=1},aspectRatio:{type:Number,default:NaN},altText:{type:String,default:"Image to crop"},minDimension:{type:Number,default:10},maxDimension:{type:Number,default:5e3},showAspectRatioOptions:{type:Boolean,default:!0}},emits:["confirm","cancel"],setup(a,{expose:z,emit:N}){const M=a,V=t(null),A=t(null),L=t(null),O=t(0),B=t(0),E=t(M.aspectRatio),S=t(!1),T=[{label:"1:1",value:1},{label:"4:3",value:4/3},{label:"16:9",value:16/9},{label:"\u81ea\u7531",value:NaN}],U=s(()=>({viewMode:2,dragMode:"move",responsive:!0,restore:!1,checkOrientation:!0,autoCropArea:.8,movable:!0,scalable:!0,zoomable:!0,rotatable:!0,aspectRatio:M.aspectRatio,preview:A.value,crop:I,ready:F})),q=()=>{S.value=window.innerWidth<768},F=()=>{if(L.value){const e=L.value.getCanvasData();O.value=Math.round(e.width),B.value=Math.round(e.height)}},I=e=>{const{width:a,height:t}=e.detail;O.value=Math.round(a),B.value=Math.round(t)},Q=()=>{L.value&&L.value.setData({width:O.value,height:B.value})},W=(e,a="image/jpeg")=>{L.value&&L.value.getCroppedCanvas().toBlob(a=>e(a),a,M.compress)};return l(()=>M.aspectRatio,e=>{E.value=e,L.value&&L.value.setAspectRatio(e)}),l(()=>M.src,e=>{L.value&&L.value.replace(e)}),i(()=>{q(),window.addEventListener("resize",q),V.value&&(L.value=new e(V.value,U.value))}),o(()=>{L.value&&L.value.destroy(),window.removeEventListener("resize",q)}),z({getCropData:(e,a="image/jpeg")=>{L.value&&e(L.value.getCroppedCanvas().toDataURL(a,M.compress))},getCropBlob:W,getCropFile:(e,a="cropped-image.jpg",t="image/jpeg")=>{W(s=>{e(new File([s],a,{type:t}))},t)},rotate:(e=90)=>{L.value&&L.value.rotate(e)},reset:()=>{L.value&&L.value.reset()}}),(e,t)=>{const s=r("ly-img"),l=r("el-input-number"),i=r("el-button"),o=r("el-button-group");return n(),p("div",b,[u("div",h,[u("div",f,[m(s,{src:a.src,ref_key:"imgRef",ref:V,class:"cropper-image",alt:a.altText},null,8,["src","alt"])]),u("div",_,[u("div",w,[t[2]||(t[2]=u("h4",{class:"section-title"},"\u88c1\u526a\u5c3a\u5bf8",-1)),u("div",x,[u("div",C,[m(l,{modelValue:O.value,"onUpdate:modelValue":t[0]||(t[0]=e=>O.value=e),min:a.minDimension,max:a.maxDimension,"controls-position":"right",size:"small",label:"\u5bbd\u5ea6",onChange:Q},null,8,["modelValue","min","max"])]),u("div",R,[m(l,{modelValue:B.value,"onUpdate:modelValue":t[1]||(t[1]=e=>B.value=e),min:a.minDimension,max:a.maxDimension,"controls-position":"right",size:"small",label:"\u9ad8\u5ea6",onChange:Q},null,8,["modelValue","min","max"])]),a.showAspectRatioOptions?(n(),p("div",D,[m(o,null,{default:c(()=>[(n(),p(d,null,j(T,e=>m(i,{key:e.value,size:"small",onClick:a=>(e=>{E.value=e,L.value&&L.value.setAspectRatio(e)})(e.value),type:E.value===e.value?"primary":""},{default:c(()=>[g(y(e.label),1)]),_:2},1032,["onClick","type"])),64))]),_:1})])):v("",!0)])]),u("div",k,[t[3]||(t[3]=u("h4",{class:"section-title"},"\u88c1\u526a\u9884\u89c8",-1)),u("div",{class:"ly-cropper__preview__img",ref_key:"previewRef",ref:A},null,512)])])])])}}},[["__scopeId","data-v-9dc9e6a2"]]);export{z as default};
