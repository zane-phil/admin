import{a as e}from"./vue-router.kfYy4LLd.js";import{a}from"./addModuleNotice.Dhb9A8G2.js";import{P as t}from"./Pagination.BCaSAlhm.js";import{_ as l,A as i,j as o}from"./index.CmK67jVc.js";import{t as s}from"./@element-plus.DmP6zw14.js";import{l as r}from"./lySearchBar.BXPoi329.js";import{E as n,a as d}from"./element-plus.BU70F6Fx.js";import{d as p,r as u,b as m,al as c,ar as f,c as v,o as g,T as j,a as h,K as y,O as w,L as _,S as b,a7 as k,M as x,R as M,Q as C,u as O,l as V,G as E,n as S}from"./@vue.CTPu-uAZ.js";import"./wangEditor.CnbmLdp2.js";import"./@wangeditor.Cjvb5x3F.js";import"./@vueuse.CxA-JytG.js";import"./axios.DpIj8wd6.js";import"./crypto-js.CDMBIImi.js";import"./clipboard.DkQLcScs.js";import"./js-cookie.Ch5AnFJE.js";import"./pinia.zQpyPaWK.js";import"./xe-utils.D2X37hqE.js";import"./sortablejs.C7MwSjUq.js";import"./vue-i18n.Diqqvor5.js";import"./@intlify.CzB25nlE.js";import"./file-saver.B7Ix4MNR.js";import"./lodash-es.inYd2OMh.js";import"./pinia-plugin-persistedstate.C_byIVBZ.js";import"./destr.WfmzGWA8.js";import"./deep-pick-omit.CDZeMyKV.js";import"./nprogress.CyzJYN2f.js";import"./@tsparticles.Csp0zpCD.js";import"./@popperjs.CT_jBSb5.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.Gu-B5VJn.js";import"./async-validator.j0i5Y79Y.js";import"./memoize-one.BAtLgO95.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.CzXNizXq.js";const z={class:"table-container"},D=["textContent"],F=["innerHTML"],L={style:{display:"flex","justify-content":"space-between","align-items":"center"}},R=["onClick"],T=["onClick"],U=p({name:"myMessage"}),H=l(Object.assign(U,{setup(l){e();const p=u(!1);u(500);const U=u(!1),H=u({page:1,limit:10,search:""}),P=u({page:1,limit:10,total:0}),q=u([{id:!0,name:"\u5df2\u8bfb"},{id:!1,name:"\u672a\u8bfb"}]),A=u([]),B=u(null),G=u(null),I=u(null);let K=u(!1);const N=()=>{p.value=!p.value,window.dispatchEvent(new Event("resize"))},Q=(e,a)=>{"detail"===a?(K.value=!0,S(()=>{let a=o(e),t=a.notification;t.id=a.id,I.value.isUserOwnMsg=!0,I.value.addModuleFn(t,"detail"),e.is_read||I.value.readMsg()})):"delete"===a?n.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684\u5185\u5bb9\uff1f","\u63d0\u793a",{type:"warning",closeOnClickModal:!1}).then(()=>{i.delOwnMessage({id:e.id}).then(e=>{2e3==e.code?(d.success(e.msg),J()):d.warning(e.msg)})}).catch(()=>{}):"reset"===a&&(H.value={page:1,limit:10,search:""},P.value={page:1,limit:10,total:0},W())},$=e=>{H.value.page=e.page,H.value.limit=e.limit,W()},J=()=>{H.value.page=1,H.value.limit=10,W()},W=async()=>{U.value=!0,i.getOwnMessage(H.value).then(e=>{U.value=!1,2e3==e.code&&(A.value=e.data.data,P.value.page=e.data.page,P.value.limit=e.data.limit,P.value.total=e.data.total)})};return m(()=>{W()}),(e,l)=>{const i=c("el-input"),o=c("el-form-item"),n=c("el-option"),d=c("el-select"),u=c("el-card"),m=c("el-table-column"),S=c("el-tag"),X=c("el-icon"),Y=c("el-tooltip"),Z=c("el-table"),ee=f("auth"),ae=f("loading");return g(),v("div",{class:E(["message-manage-container",{"ly-is-full":p.value}])},[j(u,{class:"tableSelect",ref_key:"tableSelect",ref:B,shadow:"hover"},{default:_(()=>[j(r,{model:H.value,onSearch:J,onReset:l[2]||(l[2]=e=>Q("","reset"))},{default:_(()=>[j(o,{label:"\u5173\u952e\u8bcd"},{default:_(()=>[j(i,{modelValue:H.value.search,"onUpdate:modelValue":l[0]||(l[0]=e=>H.value.search=e),modelModifiers:{trim:!0},maxlength:"60",clearable:"",placeholder:"\u6d88\u606f\u6807\u9898\u3001\u5185\u5bb9",style:{width:"160px"}},null,8,["modelValue"])]),_:1}),j(o,{label:"\u72b6\u6001"},{default:_(()=>[j(d,{modelValue:H.value.is_read,"onUpdate:modelValue":l[1]||(l[1]=e=>H.value.is_read=e),placeholder:"\u8bf7\u9009\u62e9",clearable:"",style:{width:"120px"}},{default:_(()=>[(g(!0),v(b,null,k(q.value,e=>(g(),y(n,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512),h("div",z,[x((g(),y(Z,{border:"",data:A.value,ref_key:"tableref",ref:G,style:{width:"100%",height:"100%"}},{default:_(()=>[j(m,{type:"index",width:"60",align:"center",label:"\u5e8f\u53f7"},{default:_(e=>{return[h("span",{textContent:M((a=e.$index,(P.value.page-1)*P.value.limit+a+1))},null,8,D)];var a}),_:1}),j(m,{"min-width":"150",prop:"notification.title",label:"\u6807\u9898","show-overflow-tooltip":""}),j(m,{"min-width":"200",prop:"notification.content","show-overflow-tooltip":"",label:"\u5185\u5bb9"},{default:_(e=>{return[h("div",{innerHTML:(a=e.row.notification.content,a?(a=a.replace(/<.*?>/gi,"")).length>18?a.slice(0,18)+"...":a:""),class:"ellipsis"},null,8,F)];var a}),_:1}),j(m,{"min-width":"100",label:"\u76ee\u6807\u7c7b\u578b"},{default:_(e=>[0==e.row.notification.target_type?(g(),y(S,{key:0},{default:_(()=>[...l[4]||(l[4]=[C("\u5e73\u53f0\u516c\u544a",-1)])]),_:1})):1==e.notification.row.target_type?(g(),y(S,{key:1,type:"primary"},{default:_(()=>[...l[5]||(l[5]=[C("\u6309\u7528\u6237",-1)])]),_:1})):2==e.notification.row.target_type?(g(),y(S,{key:2,type:"primary"},{default:_(()=>[...l[6]||(l[6]=[C("\u6309\u90e8\u95e8",-1)])]),_:1})):3==e.notification.row.target_type?(g(),y(S,{key:3,type:"primary"},{default:_(()=>[...l[7]||(l[7]=[C("\u6309\u89d2\u8272",-1)])]),_:1})):w("",!0)]),_:1}),j(m,{"min-width":"90",label:"\u662f\u5426\u5df2\u8bfb"},{default:_(e=>[e.row.is_read?(g(),y(S,{key:0},{default:_(()=>[...l[8]||(l[8]=[C("\u5df2\u8bfb",-1)])]),_:1})):(g(),y(S,{key:1,type:"danger"},{default:_(()=>[...l[9]||(l[9]=[C("\u672a\u8bfb",-1)])]),_:1}))]),_:1}),j(m,{"min-width":"150",prop:"notification.create_datetime",label:"\u521b\u5efa\u65f6\u95f4"}),j(m,{label:"\u64cd\u4f5c",fixed:"right",width:"180"},{header:_(()=>[h("div",L,[l[10]||(l[10]=h("div",null,"\u64cd\u4f5c",-1)),h("div",{onClick:N},[j(Y,{content:"\u5168\u5c4f",placement:"bottom"},{default:_(()=>[j(X,null,{default:_(()=>[j(O(s))]),_:1})]),_:1})])])]),default:_(e=>[x((g(),v("span",{class:"table-operate-btn",onClick:a=>Q(e.row,"detail")},[...l[11]||(l[11]=[C("\u8be6\u60c5",-1)])],8,R)),[[ee,"Detail"]]),x((g(),v("span",{class:"table-operate-btn delete",onClick:a=>Q(e.row,"delete")},[...l[12]||(l[12]=[C("\u5220\u9664",-1)])],8,T)),[[ee,"Delete"]])]),_:1})]),_:1},8,["data"])),[[ae,U.value]])]),j(t,{"child-msg":P.value,onCallFather:$},null,8,["child-msg"]),O(K)?(g(),y(a,{key:0,ref_key:"addModuleFlag",ref:I,onRefreshData:W,onClosed:l[3]||(l[3]=e=>V(K)?K.value=!1:K=!1)},null,512)):w("",!0)],2)}}}),[["__scopeId","data-v-7ddf56fb"]]);export{H as default};
