import{a as e}from"./vue-router.kfYy4LLd.js";import{U as l,t as a}from"./@element-plus.DmP6zw14.js";import{P as t}from"./Pagination.BCaSAlhm.js";import{_ as o,l as s,u as r,t as i,A as n,v as d}from"./index.CmK67jVc.js";import{r as u,al as p,K as c,o as m,L as v,T as f,a as _,R as h,Q as b,d as g,j,b as w,n as y,e as k,ar as q,c as x,M,u as D,G as C}from"./@vue.CTPu-uAZ.js";import{l as V}from"./lySearchBar.BXPoi329.js";import{E as z,a as O}from"./element-plus.BU70F6Fx.js";import"./axios.DpIj8wd6.js";import"./crypto-js.CDMBIImi.js";import"./clipboard.DkQLcScs.js";import"./js-cookie.Ch5AnFJE.js";import"./pinia.zQpyPaWK.js";import"./xe-utils.D2X37hqE.js";import"./sortablejs.C7MwSjUq.js";import"./vue-i18n.Diqqvor5.js";import"./@intlify.CzB25nlE.js";import"./file-saver.B7Ix4MNR.js";import"./lodash-es.inYd2OMh.js";import"./pinia-plugin-persistedstate.C_byIVBZ.js";import"./destr.WfmzGWA8.js";import"./deep-pick-omit.CDZeMyKV.js";import"./nprogress.CyzJYN2f.js";import"./@tsparticles.Csp0zpCD.js";import"./@vueuse.CxA-JytG.js";import"./@popperjs.CT_jBSb5.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.Gu-B5VJn.js";import"./async-validator.j0i5Y79Y.js";import"./memoize-one.BAtLgO95.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.CzXNizXq.js";const A={class:"detail-content"},S={class:"detail-content"},I={class:"detail-content"},P={class:"detail-content"},E={class:"detail-content"},F={class:"detail-content"},U={class:"detail-content"},B={class:"detail-content"},L=o({__name:"journalManageDetail",setup(e,{expose:l}){const a=u(!1),t=u("\u65e5\u5fd7\u8be6\u60c5"),o=u(null),r=()=>{a.value=!1,o.value=null};return l({journalManageDetailFn:e=>{o.value=e,a.value=!0}}),(e,l)=>{const i=p("el-form-item"),n=p("el-tag"),d=p("el-form"),u=p("el-button");return m(),c(s,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value=e),title:t.value,width:"50%","before-close":r},{footer:v(()=>[f(u,{onClick:r},{default:v(()=>[...l[1]||(l[1]=[b("\u5173\u95ed",-1)])]),_:1})]),default:v(()=>[f(d,{"label-position":"right",class:"journal-detail","label-width":"auto"},{default:v(()=>[f(i,{label:"\u8bf7\u6c42\u6a21\u5757\uff1a"},{default:v(()=>[_("div",A,h(o.value?.req_modular||""),1)]),_:1}),f(i,{label:"\u8bf7\u6c42\u5730\u5740\uff1a"},{default:v(()=>[_("div",S,h(o.value?.req_path||""),1)]),_:1}),f(i,{label:"\u8bf7\u6c42\u65b9\u6cd5\uff1a"},{default:v(()=>[_("div",I,h(o.value?.req_method||""),1)]),_:1}),f(i,{label:"IP\u5730\u5740\uff1a"},{default:v(()=>[_("div",P,h(o.value?.req_ip||""),1)]),_:1}),f(i,{label:"IP\u5f52\u5c5e\u5730\uff1a"},{default:v(()=>[_("div",E,h(o.value?.ip_area||""),1)]),_:1}),f(i,{label:"\u8bf7\u6c42\u6d4f\u89c8\u5668\uff1a"},{default:v(()=>[_("div",F,h(o.value?.req_browser||""),1)]),_:1}),f(i,{label:"\u8bf7\u6c42\u6570\u636e\uff1a"},{default:v(()=>[b(h(o.value&&o.value.req_body?o.value.req_body:""),1)]),_:1}),f(i,{label:"\u54cd\u5e94\u7801\uff1a"},{default:v(()=>[f(n,{type:"2000"===o.value?.resp_code?"success":"warning"},{default:v(()=>[b(h(o.value?.resp_code||""),1)]),_:1},8,["type"])]),_:1}),f(i,{label:"\u8fd4\u56de\u4fe1\u606f\uff1a"},{default:v(()=>[b(h(o.value?.json_result?o.value.json_result:""),1)]),_:1}),f(i,{label:"\u64cd\u4f5c\u4eba\uff1a"},{default:v(()=>[_("div",U,h(o.value?.creator_name||""),1)]),_:1}),f(i,{label:"\u521b\u5efa\u65f6\u95f4\uff1a"},{default:v(()=>[_("div",B,h(o.value?.create_datetime||""),1)]),_:1})]),_:1})]),_:1},8,["modelValue","title"])}}},[["__scopeId","data-v-33f1c24b"]]),T={class:"table-container"},J={class:"json-cell"},N={class:"json-popover-content"},R={key:1},G={key:1},H={class:"json-cell"},K={class:"json-popover-content"},Q={key:1},W={class:"table-header-actions"},X=["onClick"],Y=g({name:"journalManage"}),Z=o(Object.assign(Y,{setup(o){const s=r();e();const g=u(!1),A=u(500),S=u(!1),I=u(null),P=u(null);u(null);const E=u({page:1,limit:20}),F=u([]),U=u([]),B=u({page:1,limit:20,total:0});let Y=j(()=>s.ismobile);const Z=e=>{if(!e)return e;if("object"==typeof e)return e;try{return JSON.parse(e)}catch(l){try{const l=e.replace(/'/g,'"');return JSON.parse(l)}catch(a){return e}}},$=()=>{z.confirm("\u662f\u5426\u786e\u8ba4\u6e05\u7a7a\u5168\u90e8\u65e5\u5fd7\u6570\u636e","\u8b66\u544a",{confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then(()=>{n.systemOperationlogDeletealllogsDelete().then(e=>{2e3==e.code?(O.success(e.msg),ae()):O.warning(e.msg)})}).catch(()=>{})},ee=(e,l)=>{"detail"===l?P.value.journalManageDetailFn(e):"delete"===l?z.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684\u6570\u636e\u5417\uff1f",{closeOnClickModal:!1}).then(()=>{n.systemOperationlogDelete({id:e.id}).then(e=>{2e3==e.code?(O.success(e.msg),oe()):O.warning(e.msg)})}).catch(()=>{}):"reset"===l&&(E.value={page:1,limit:20},B.value={page:1,limit:20,total:0},F.value=[],oe())},le=e=>{E.value.page=e.page,E.value.limit=e.limit,oe()},ae=()=>{E.value.page=1,E.value.limit=20,oe()},te=e=>{e?(E.value.beginAt=d(e[0],"yyyy-MM-dd hh:mm:ss"),E.value.endAt=d(e[1],"yyyy-MM-dd hh:mm:ss")):(E.value.beginAt=null,E.value.endAt=null)},oe=async()=>{try{S.value=!0;const e=await n.systemOperationlog(E.value);2e3==e.code&&(U.value=e.data.data,B.value.page=e.data.page,B.value.limit=e.data.limit,B.value.total=e.data.total)}finally{S.value=!1}},se=()=>{g.value=!g.value,y(()=>{re()})},re=()=>{const e=I.value?I.value.offsetHeight:0,l=g.value?e-110:e;A.value=i(l)},ie=()=>{y(()=>{re()})};return w(()=>{window.addEventListener("resize",ie),y(()=>{re()}),oe()}),k(()=>{window.removeEventListener("resize",ie)}),(e,o)=>{const s=p("el-button"),r=p("el-input"),i=p("el-form-item"),n=p("el-date-picker"),d=p("el-card"),u=p("el-table-column"),j=p("el-icon"),w=p("el-tag"),y=p("el-popover"),k=p("el-tooltip"),z=p("el-table"),O=q("auth"),A=q("loading");return m(),x("div",{class:C(["journal-manage-container",{"ly-is-full":g.value}])},[f(d,{class:"tableSelect",ref_key:"tableSelect",ref:I,shadow:"hover"},{default:v(()=>[f(V,{model:E.value,onSearch:ae,onReset:o[2]||(o[2]=e=>ee("","reset"))},{"actions-right":v(()=>[M((m(),c(s,{onClick:$,type:"danger"},{default:v(()=>[...o[3]||(o[3]=[b(" \u5168\u90e8\u6e05\u7a7a ",-1)])]),_:1})),[[O,"DeleteAll"]])]),default:v(()=>[f(i,{label:"\u5173\u952e\u8bcd"},{default:v(()=>[f(r,{modelValue:E.value.search,"onUpdate:modelValue":o[0]||(o[0]=e=>E.value.search=e),modelModifiers:{trim:!0},maxlength:"60",clearable:"",placeholder:"\u5173\u952e\u8bcd",style:{width:"160px"}},null,8,["modelValue"])]),_:1}),f(i,{label:"\u521b\u5efa\u65f6\u95f4"},{default:v(()=>[f(n,{modelValue:F.value,"onUpdate:modelValue":o[1]||(o[1]=e=>F.value=e),type:"datetimerange",onChange:te,"range-separator":"\u81f3","start-placeholder":"\u5f00\u59cb\u65e5\u671f","end-placeholder":"\u7ed3\u675f\u65e5\u671f"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},512),_("div",T,[M((m(),c(z,{border:"",data:U.value,style:{width:"100%",height:"100%"},flexible:!0},{default:v(()=>[f(u,{"min-width":"100",prop:"req_modular",label:"\u8bf7\u6c42\u6a21\u5757","show-overflow-tooltip":""}),f(u,{"min-width":"160",prop:"req_path",label:"\u8bf7\u6c42\u5730\u5740","show-overflow-tooltip":""}),f(u,{width:"90",prop:"req_method",label:"\u8bf7\u6c42\u65b9\u6cd5","show-overflow-tooltip":""}),f(u,{"min-width":"100",prop:"req_ip",label:"IP\u5730\u5740","show-overflow-tooltip":""}),f(u,{"min-width":"130",prop:"req_browser",label:"\u8bf7\u6c42\u6d4f\u89c8\u5668","show-overflow-tooltip":""}),f(u,{width:"90",prop:"req_body",label:"\u8bf7\u6c42\u6570\u636e"},{default:v(({row:e})=>[_("div",J,[e.req_body?(m(),c(y,{key:0,placement:D(Y)?"bottom":"left-start",trigger:"click",width:D(Y)?"80%":"50%","show-arrow":!1},{reference:v(()=>[f(w,{class:"json-tag",size:"small",effect:"dark"},{default:v(()=>[f(j,null,{default:v(()=>[f(D(l))]),_:1})]),_:1})]),default:v(()=>[_("div",N,[_("pre",null,h(Z(e.req_body)),1)])]),_:2},1032,["placement","width"])):(m(),x("span",R,"\u65e0"))])]),_:1}),f(u,{width:"80",prop:"resp_code",label:"\u54cd\u5e94\u7801"},{default:v(({row:e})=>[e.resp_code?(m(),c(w,{key:0,type:"2000"===e.resp_code?"success":"warning"},{default:v(()=>[b(h(e.resp_code),1)]),_:2},1032,["type"])):(m(),x("span",G))]),_:1}),f(u,{width:"90",prop:"json_result",label:"\u8fd4\u56de\u4fe1\u606f"},{default:v(({row:e})=>[_("div",H,[e.json_result?(m(),c(y,{key:0,placement:D(Y)?"bottom":"left-start",trigger:"click",width:D(Y)?"80%":"50%","show-arrow":!1},{reference:v(()=>[f(w,{class:"json-tag",size:"small",effect:"dark"},{default:v(()=>[f(j,null,{default:v(()=>[f(D(l))]),_:1})]),_:1})]),default:v(()=>[_("div",K,[_("pre",null,h(Z(e.json_result)),1)])]),_:2},1032,["placement","width"])):(m(),x("span",Q,"\u65e0"))])]),_:1}),f(u,{width:"130",prop:"creator_name",label:"\u64cd\u4f5c\u4eba"}),f(u,{width:"160",prop:"create_datetime",label:"\u521b\u5efa\u65f6\u95f4","show-overflow-tooltip":""}),f(u,{label:"\u64cd\u4f5c",fixed:"right",width:"120"},{header:v(()=>[_("div",W,[o[4]||(o[4]=_("span",null,"\u64cd\u4f5c",-1)),f(k,{content:"\u5168\u5c4f",placement:"bottom"},{default:v(()=>[f(j,{onClick:se},{default:v(()=>[f(D(a))]),_:1})]),_:1})])]),default:v(({row:e})=>[M((m(),x("span",{class:"table-operate-btn delete",onClick:l=>ee(e,"delete")},[...o[5]||(o[5]=[b("\u5220\u9664",-1)])],8,X)),[[O,"Delete"]])]),_:1})]),_:1},8,["data"])),[[A,S.value]])]),f(t,{"child-msg":B.value,onCallFather:le},null,8,["child-msg"]),f(L,{ref_key:"journalManageDetailFlag",ref:P},null,512)],2)}}}),[["__scopeId","data-v-5cd338d5"]]);export{Z as default};
